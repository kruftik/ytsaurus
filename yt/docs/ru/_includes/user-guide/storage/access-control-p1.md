# Общие сведения

В данном разделе собрана информация о системе контроля доступа к таблицам и другим узлам [Кипариса](../../../user-guide/storage/cypress.md) (пользователям, группам, аккаунтам, чанкам, транзакциям и т.д.).

Любой пользовательский запрос проходит через прокси, которые [**аутентифицируют**](https://{{lang}}.wikipedia.org/wiki/Authentication) пользователя, то есть проверяют его подлинность. На основе содержащегося в запросе токена, полученного с помощью протокола [OAuth](https://{{lang}}.wikipedia.org/wiki/OAuth), прокси определяет имя пользователя, инициировавшего запрос. Если токен в запросе не указан, то считается, что запрос задан от пользователя `guest`. После прохождения аутентификации, на последующих этапах обработки пользовательского запроса токен не используется. Подробнее о токенах можно прочитать в разделе [Аутентификация](../../../user-guide/storage/auth.md).

**Авторизацией** (выдачей разрешений) занимается мастер-сервер Кипариса. Решение о предоставлении или отказе в доступе зависит от:

1. Вида доступа (чтение, запись и т.д.);
2. Пользователя, инициировавшего запрос;
3. Объекта, к которому запрашивается доступ.

В случае отказа в праве доступа формируется сообщение в котором указаны детали: имя пользователя, которому отказано в доступе, объект, к которому запрашивался доступ, и тип доступа.

В системе {{product-name}} поддерживаются списки **пользователей** и **групп**. Обобщенно пользователи и группы называются **субъектами**.

У каждого объекта в системе {{product-name}} существует список контроля доступа (**Access Control List** или **ACL**). Данный список хранится в атрибуте `@acl` объекта и состоит из отдельных записей (**Access Control Entry** или **ACE**), где каждая запись содержит перечень субъектов, тип доступа и ряд других параметров, приведённых в таблице раздела [Авторизация](../../../user-guide/storage/access-control.md#authorization).

## Пользователи, группы { #users_groups }

Список всех зарегистрированных пользователей системы хранится в Кипарисе по адресу `//sys/users`. Каждый пользователь определяется уникальным именем. Если от прокси приходит запрос, помеченный именем несуществующего пользователя, то мастер-сервер вернет ошибку `No such user`. Такая ситуация потенциально возможна, поскольку получение токена и регистрация пользователя в системе — два действия, выполняемые на различных сервисах (получение токена происходит с помощью сервиса OAuth, а регистрация — на мастер-сервере {{product-name}}).

Список всех зарегистрированных групп располагается по адресу `//sys/groups`. Каждая группа также определяется уникальным именем.

{% note warning "Внимание" %}

Пользователи и группы располагаются в одном пространстве имен, то есть имена пользователей и групп не могут совпадать.

{% endnote %}

Членами групп могут быть произвольные субъекты: как пользователи, так и другие группы. Система гарантирует, что отношение "вхождение в группу" не содержит циклов. При авторизации решения принимаются на основе транзитивного замыкания. Таким образом, пользователь `A` может быть членом группы `C` как напрямую (входить непосредственно в состав группы `С`), так и косвенно (`A` входит в группу `B`, а группа `B` — в группу `C`).
